#!/usr/bin/julia
using Comonicon
using AllocationOpt

"""
Optimises an indexer's allocations.

# Arguments

- `id`: The id of the indexer to optimise.
- `filepath`: A path to the CSV file that contains whitelist, blacklist, pinnedlist, frozenlist as columns.
- `grtgas`: The maximum amount of GRT that you are willing to spend on each allocation transaction.
- `minimum_allocation_amount`: The minimum amount of GRT that you are willing to allocate to a subgraph.
- `allocation_lifetime`: The number of epoches you assume to open each allocations for. Lifetime 1 means you are reallocating every epoch. 

"""
@main function main(id, filepath, grtgas, minimum_allocation_amount, allocation_lifetime)
    ω = optimize_indexer(id, filepath, parse(Float64, grtgas), parse(Float64, minimum_allocation_amount), parse(Int64, allocation_lifetime))
    @show ω
    # TODO: Push results to action queue
end
